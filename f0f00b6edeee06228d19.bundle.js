!function(){"use strict";var t,e,i={965:function(t,e,i){i.d(e,{UI:function(){return f},ab:function(){return u},fP:function(){return m},HN:function(){return d},ub:function(){return v},Kx:function(){return h},Tr:function(){return p},Tl:function(){return g},t8:function(){return c},w_:function(){return l},$3:function(){return r},QX:function(){return b}});var s=i(896);function o(){return"serviceWorker"in navigator?navigator.serviceWorker.getRegistration().then((t=>t.pushManager.getSubscription().then((e=>null!=e?e:t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:s.c.NOTIFICATION_PUBLIC_KEY}).then((function(t){return t}),(function(t){console.log(t)})))))):Promise.reject("No serviceworker")}function n(){return window.localStorage.getItem("user_id")}function a(t){return window.localStorage.setItem("user_id",t.user_id),t}function h(){return fetch(`${s.c.API_URL}measurements`,{headers:{Accept:"application/json"}}).then((t=>t.json()))}function r(t,e,i,o){return fetch(`${s.c.API_URL}measurements`,{body:JSON.stringify({i:t,t:100*e,h:100*i,p:1e4*o}),method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((t=>t.text()))}function l(){return fetch(`${s.c.API_URL}sensors`,{headers:{Accept:"application/json"}}).then((t=>t.json()))}function c(){return null==n()?Promise.resolve([]):fetch(`${s.c.API_URL}rooms?user_id=${n()}`,{headers:{Accept:"application/json"}}).then((t=>t.json()))}function d(t){return fetch(`${s.c.API_URL}rooms?room_id=${t}`,{method:"DELETE",headers:{Accept:"application/json"}}).then((t=>t.text()))}function u(t,e,i,o){return fetch(`${s.c.API_URL}rooms`,{body:JSON.stringify({user_id:n(),name:t,type:e,sensor_id1:i,sensor_id2:o}),method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((t=>t.json())).then(a)}function p(){return null==n()?Promise.resolve([]):fetch(`${s.c.API_URL}notifications?user_id=${n()}`,{headers:{Accept:"application/json"}}).then((t=>t.json()))}function m(t){return fetch(`${s.c.API_URL}notifications?notification_id=${t}`,{method:"DELETE",headers:{Accept:"application/json"}}).then((t=>t.text()))}function f(t,e,i,h,r,l){return o().then((o=>{let c=JSON.parse(JSON.stringify(o));if(console.log(c),"voltage"==l){let t=640;r=t+.01*r*(1024-t)}return fetch(`${s.c.API_URL}notifications`,{body:JSON.stringify({user_id:n(),type:h,value:l,room_id1:e,room_id2:i,amount:r,message:t,endpoint:c.endpoint,keys:c.keys}),method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((t=>t.json())).then(a)}))}function g(t,e){if(null==n())return Promise.resolve([]);let i=`${s.c.API_URL}roomMeasurements?user_id=${n()}&after=${t.toISOString()}`;return e&&(i+=`&before=${e.toISOString()}`),fetch(i,{headers:{Accept:"application/json"}}).then((t=>t.json()))}function v(){return null==n()?Promise.resolve([]):fetch(`${s.c.API_URL}currentroommeasurements?user_id=${n()}`,{headers:{Accept:"application/json"}}).then((t=>t.json()))}let w=null;async function b(){"granted"!==Notification.permission&&Promise.resolve();let t=n();return null==t?Promise.resolve():(await navigator.serviceWorker.ready,o().then((e=>{let i=JSON.parse(JSON.stringify(e));JSON.stringify(i)!=JSON.stringify(w)?fetch(`${s.c.API_URL}pushSubscriptionUpdate`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({user_id:t,update:i})}).then((t=>t.json())).then((t=>{null==t.error&&(w=i)})):console.log("Push Notification Subscription did not change since App start. Not updating again.")})))}},896:function(t,e,i){i.d(e,{c:function(){return o}});let s="https://antischwitzomat.glitch.me/";const o={API_URL:s,api:`${s}measurements`,ROOM_MEASUREMENTS:`${s}roommeasurements`,NOTIFICATIONS_URL:`${s}notifications`,NOTIFICATION_PUBLIC_KEY:"BPpC0dcJVJWCBwjKNWPJW4o75bZpfiqUtGAU3Du18npgjqtCDqfWLMbHjIkMQAbDvcuPbP5eLfL9ZDSxilOFq0I"}}},s={};function o(t){var e=s[t];if(void 0!==e)return e.exports;var n=s[t]={exports:{}};return i[t](n,n.exports,o),n.exports}o.m=i,o.d=function(t,e){for(var i in e)o.o(e,i)&&!o.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},o.f={},o.e=function(t){return Promise.all(Object.keys(o.f).reduce((function(e,i){return o.f[i](t,e),e}),[]))},o.u=function(t){return"9cc1a6285630fa1c0c7a.bundle.js"},o.miniCssF=function(t){},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},t={},e="antischwitzomatclient:",o.l=function(i,s,n,a){if(t[i])t[i].push(s);else{var h,r;if(void 0!==n)for(var l=document.getElementsByTagName("script"),c=0;c<l.length;c++){var d=l[c];if(d.getAttribute("src")==i||d.getAttribute("data-webpack")==e+n){h=d;break}}h||(r=!0,(h=document.createElement("script")).charset="utf-8",h.timeout=120,o.nc&&h.setAttribute("nonce",o.nc),h.setAttribute("data-webpack",e+n),h.src=i),t[i]=[s];var u=function(e,s){h.onerror=h.onload=null,clearTimeout(p);var o=t[i];if(delete t[i],h.parentNode&&h.parentNode.removeChild(h),o&&o.forEach((function(t){return t(s)})),e)return e(s)},p=setTimeout(u.bind(null,void 0,{type:"timeout",target:h}),12e4);h.onerror=u.bind(null,h.onerror),h.onload=u.bind(null,h.onload),r&&document.head.appendChild(h)}},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.p="/AntischwitzomatClient/",function(){var t={57:0};o.f.j=function(e,i){var s=o.o(t,e)?t[e]:void 0;if(0!==s)if(s)i.push(s[2]);else{var n=new Promise((function(i,o){s=t[e]=[i,o]}));i.push(s[2]=n);var a=o.p+o.u(e),h=new Error;o.l(a,(function(i){if(o.o(t,e)&&(0!==(s=t[e])&&(t[e]=void 0),s)){var n=i&&("load"===i.type?"missing":i.type),a=i&&i.target&&i.target.src;h.message="Loading chunk "+e+" failed.\n("+n+": "+a+")",h.name="ChunkLoadError",h.type=n,h.request=a,s[1](h)}}),"chunk-"+e,e)}};var e=function(e,i){var s,n,a=i[0],h=i[1],r=i[2],l=0;if(a.some((function(e){return 0!==t[e]}))){for(s in h)o.o(h,s)&&(o.m[s]=h[s]);r&&r(o)}for(e&&e(i);l<a.length;l++)n=a[l],o.o(t,n)&&t[n]&&t[n][0](),t[n]=0},i=self.webpackChunkantischwitzomatclient=self.webpackChunkantischwitzomatclient||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))}(),function(){function t(t,e,i,s,o,n,a,h){this.initialize(t,e,i,s,o,n,a,h),window.addEventListener("resize",function(t){this.initialize(this.div,this.prefix,this.value,this.suffix,this.min,this.max,this.background,this.textColor),this.setValue(i)}.bind(this))}function e(t,i,s){this.r=t,this.g=i,this.b=s,this.rgb=function(){return"rgb("+this.r+","+this.g+","+this.b+")"},this.mix=function(t,i){var s=this.r-i*(this.r-t.r),o=this.g-i*(this.g-t.g);return t=this.b-i*(this.b-t.b),new e(s*(i=255/Math.max(s,o,t)),o*i,t*i)}}window.Gauge=t,t.prototype.initialize=function(t,e,i,s,o,n,a,h){this.doWhenLoaded((function(){this.div=t,this.prefix=e,this.value=i,this.suffix=s,this.min=o,this.max=n,this.background=a,this.textColor=h,this.generateCanvas(t),this.size=this.height<this.width?this.height:this.width,this.min=o,this.max=n,this.canvas.style["background-color"]=a,this.textColor=h}))},t.prototype.generateCanvas=function(t){var e=window.devicePixelRatio||1,i=t.getBoundingClientRect(),s=document.createElement("canvas");this.width=Math.round(i.width),this.height=Math.round(i.height),s.width=this.width*e,s.height=this.height*e,this.ctx=s.getContext("2d"),this.ctx.scale(e,e),t.style.position="relative",t.style.overflow="hidden",t.style.top="0px",t.style.left="0px",s.style.position="absolute",s.style.top="0px",s.style.left="0px",s.style.height=this.height+"px",s.style.width=this.width+"px",t.innerHTML="",t.appendChild(s),this.canvas=s},t.prototype.setValue=function(t,i){null==i&&(i=t),this.ctx.clearRect(0,0,this.width,this.height);for(var s=(this.max+"").length-(i+"").length,o="",n=0;n<s;n++)o=" "+o;i=o+this.prefix+i+this.suffix+"",o=200,this.ctx.font="bold "+o+"px monospace, Arial, Helvetica, sans-serif",n=this.ctx.measureText(i).width,s=.9*this.size/2,o=n/o,o=Math.sqrt(s*s/(.25+o*o/4)),o=Math.round(.85*o),this.ctx.font="bold "+o+"px monospace, Arial, Helvetica, sans-serif",this.ctx.fillStyle=this.textColor,this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.fillText(i,this.width/2,this.height/2),t=(t-this.min)/(this.max-this.min),this.ctx.beginPath(),this.ctx.lineWidth=.08*this.size,i=new e(0,0,255),s=new e(255,0,0),this.ctx.strokeStyle=i.mix(s,t).rgb(),this.ctx.arc(this.width/2,this.height/2,.9*this.size/2,Math.PI-Math.PI/4,Math.PI/4-(1-t)*(Math.PI+Math.PI/2),!1),this.ctx.stroke()},t.prototype.animateValue=function(t,e){this.doWhenLoaded((function(){this.currentValue=this.min,this.value=t,this.animationTime=e,window.requestAnimationFrame(this.animation.bind(this))}))},t.prototype.animation=function(t){if(this.lastTime){var e=t-this.lastTime;this.lastTime=t,this.currentValue+=(this.value-this.min)*e/this.animationTime}else this.firstTime=this.lastTime=t;this.setValue(this.currentValue,this.value),this.currentValue<this.value?window.requestAnimationFrame(this.animation.bind(this)):this.setValue(this.value,this.value)};var i=!1;window.addEventListener("load",(function(){i=!0})),t.prototype.doWhenLoaded=function(t){i?t.bind(this)():window.addEventListener("load",function(){t.bind(this)()}.bind(this))}}.call(window),function(){var t=t||{};function e(t,e){this.div=t,this.config=e,this.initialize(t,e),window.addEventListener("resize",function(t){this.initialize(this.div,this.config)}.bind(this))}function i(t,e){return Math.floor(t*Math.pow(10,e))/Math.pow(10,e)}function s(t,e){return Math.ceil(t*Math.pow(10,e))/Math.pow(10,e)}function o(t,e,i,s){for(var o=[],n=0;n<t.length;n++)o[n]=e*(t[n]-i)+s;return o}function n(t,e,i,s,o){for(var n=[],a=0;a<t.length;a++)n[a]=o-e*(t[a]-i)-s;return n}function a(t,e,i,s,o,n){e/=s/=20,i/=s,n.save(),n.font="20px Arial, Helvetica, sans-serif",n.fillStyle=o,n.scale(s,s),n.textAlign="center",n.textBaseline="middle",n.fillText(t,e,i),n.restore()}function h(t,e,i,s,o){o.beginPath(),o.strokeStyle=t,o.lineWidth=1,o.moveTo(e,i),o.lineTo(e+s,i),o.stroke()}function r(t,e,i,s,o){o.beginPath(),o.strokeStyle=t,o.lineWidth=1,o.moveTo(e,i),o.lineTo(e,i-s),o.stroke()}function l(t,e,i,s,o,n,a){for(var h=0;h<t.length;h++)c(t[h],e[h],i,s,o,n,a)}t.scope={},t.ASSUME_ES5=!1,t.ASSUME_NO_NATIVE_MAP=!1,t.ASSUME_NO_NATIVE_SET=!1,t.SIMPLE_FROUND_POLYFILL=!1,t.defineProperty=t.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,i){t!=Array.prototype&&t!=Object.prototype&&(t[e]=i.value)},t.getGlobal=function(t){return"undefined"!=typeof window&&window===t?t:"undefined"!=typeof global&&null!=global?global:t},t.global=t.getGlobal(this),t.polyfill=function(e,i,s,o){if(i){for(s=t.global,e=e.split("."),o=0;o<e.length-1;o++){var n=e[o];n in s||(s[n]={}),s=s[n]}(i=i(o=s[e=e[e.length-1]]))!=o&&null!=i&&t.defineProperty(s,e,{configurable:!0,writable:!0,value:i})}},t.polyfill("Array.prototype.fill",(function(t){return t||function(t,e,i){var s=this.length||0;for(0>e&&(e=Math.max(0,s+e)),(null==i||i>s)&&(i=s),0>(i=Number(i))&&(i=Math.max(0,s+i)),e=Number(e||0);e<i;e++)this[e]=t;return this}}),"es6","es3"),window.Plot=e,e.prototype.initialize=function(t,e){this.doWhenLoaded((function(){for(var i in this.generateCanvas(t),e)this[i]=e[i];this.applyDefaultSettings(),this.bottomMargin=0,this.ctx=this.canvas.getContext("2d"),this.canvas.style["background-color"]=this.backgroundColor,this.calculateDataRanges(),this.calculateDrawingRanges(),this.calculateDrawingProperties(),this.scaleData(),this.draw()}))},e.prototype.generateCanvas=function(t){var e=window.devicePixelRatio||1,i=t.getBoundingClientRect(),s=document.createElement("canvas");this.width=Math.round(i.width),this.height=Math.round(i.height),s.width=this.width*e,s.height=this.height*e,this.ctx=s.getContext("2d"),this.ctx.scale(e,e),t.style.position="relative",t.style.overflow="hidden",t.style.top="0px",t.style.left="0px",s.style.position="absolute",s.style.top="0px",s.style.left="0px",s.style.height=this.height+"px",s.style.width=this.width+"px",t.innerHTML="",t.appendChild(s),this.canvas=s},e.prototype.applyDefaultSettings=function(){var t,e={backgroundColor:"#4caf50",xAxisSize:.05,yAxisSize:.05,topMargin:.05,rightMargin:.05,xAxisLabelMaxDecimals:2,yAxisLabelMaxDecimals:2,yAxisLabelSuffix:"",yAxisLabelPrefix:"",xAxisLabelSuffix:"",xAxisLabelPrefix:"",xAxisMaxLabels:11,yAxisMaxLabels:15,drawGridLineX:!0,drawGridLineY:!0,preferredLabelStepsX:[1,2,2.5,5],preferredLabelStepsY:[1,2,2.5,5],equalLabelSize:!0},i={type:"line",color:"#fff",linewidth:5,dataPointRadius:4,dataPointLinewidth:2,xHighlight:[],yHighlight:[]},s={color:"#fff",shadowColor:"#80e27e",linewidth:4,dataPointRadius:1.5,xHighlight:[],yHighlight:[]};for(t in e)null==this[t]&&(this[t]=e[t]);for(e=this.graphs.length,t=0;t<e;t++)if("shadow"==this.graphs[t].type)for(var o in s)null==this.graphs[t][o]&&(this.graphs[t][o]=s[o]);else for(o in i)null==this.graphs[t][o]&&(this.graphs[t][o]=i[o])},e.prototype.calculateDataRanges=function(){this.allXData=[],this.allYData=[];for(var t=0;t<this.graphs.length;t++)this.allXData=this.allXData.concat(this.graphs[t].x),this.allXData=this.allXData.concat(this.graphs[t].xHighlight),this.allYData=this.allYData.concat(this.graphs[t].y),this.allYData=this.allYData.concat(this.graphs[t].yHighlight);this.minX=Math.min.apply(null,this.allXData),this.minY=Math.min.apply(null,this.allYData),this.maxX=Math.max.apply(null,this.allXData),this.maxY=Math.max.apply(null,this.allYData),this.xDataRange=this.maxX-this.minX,this.yDataRange=this.maxY-this.minY,this.orderX=.1*m(this.xDataRange),(t=Math.pow(10,-this.xAxisLabelMaxDecimals))>this.orderX&&(this.orderX=t),this.decimalsX=-f(this.orderX),this.orderY=.1*m(this.yDataRange),(t=Math.pow(10,-this.yAxisLabelMaxDecimals))>this.orderY&&(this.orderY=t),this.decimalsY=-f(this.orderY)},e.prototype.calculateDrawingRanges=function(t,e,o,n){this.minPlottingX=null==t?i(Math.min.apply(null,this.allXData),this.decimalsX):t,this.minPlottingY=null==e?i(Math.min.apply(null,this.allYData),this.decimalsY):e,this.maxPlottingX=null==o?s(Math.max.apply(null,this.allXData),this.decimalsX):o,this.maxPlottingY=null==n?s(Math.max.apply(null,this.allYData),this.decimalsY):n,this.xPlottingRange=this.maxPlottingX-this.minPlottingX,this.yPlottingRange=this.maxPlottingY-this.minPlottingY,this.xScaling=this.width/this.xPlottingRange,this.yScaling=this.height/this.yPlottingRange,this.yScaling*=1-(this.topMargin+this.bottomMargin+this.xAxisSize),this.xScaling*=1-this.yAxisSize-this.rightMargin,this.bottomOffset=(this.bottomMargin+this.xAxisSize)*this.height,this.topOffset=this.topMargin*this.height,this.leftOffset=this.yAxisSize*this.width,this.rightOffset=this.rightMargin*this.width,this.bottom=this.height},e.prototype.scaleData=function(){for(var t=0;t<this.graphs.length;t++)this.graphs[t].xCoordinates=o(this.graphs[t].x,this.xScaling,this.minPlottingX,this.leftOffset),this.graphs[t].yCoordinates=n(this.graphs[t].y,this.yScaling,this.minPlottingY,this.bottomOffset,this.bottom),this.graphs[t].xCoordinatesHighlight=o(this.graphs[t].xHighlight,this.xScaling,this.minPlottingX,this.leftOffset),this.graphs[t].yCoordinatesHighlight=n(this.graphs[t].yHighlight,this.yScaling,this.minPlottingY,this.bottomOffset,this.bottom)},e.prototype.calculateLabelHeightYaxis=function(){var t=p(this.maxPlottingY+this.dataStepSizeY,this.yAxisLabelMaxDecimals);isNaN(t)&&!isNaN(this.maxPlottingY+this.dataStepSizeY)&&console.error("To many decimals, or numbers to long, cannot round, try reducing MaxDecimals"),this.longestLabelY=t.toString().length+this.yAxisLabelPrefix.length+this.yAxisLabelSuffix.length,this.labelHeightY=1.5*this.yAxisWidth/this.longestLabelY},e.prototype.calculateDrawingProperties=function(){this.calculateDrawingPropertiesX(),this.calculateDrawingPropertiesY(),this.xLabelNames?(this.gridLineCountX=this.xLabelNames.length,this.drawingStepSizeX=this.xAxisWidth/(this.gridLineCountX-1),this.dataStepSizeX=this.xDataRange/(this.gridLineCountX-1),this.calculateDrawingRanges(null,null,null,null)):this.calculateStepSizeX(),this.calculateStepSizeY()},e.prototype.calculateDrawingPropertiesX=function(){this.xAxisHeight=this.bottomOffset,this.xAxisWidth=this.width-this.leftOffset-this.rightOffset,this.longestLabelX=p(this.maxPlottingX,this.xAxisLabelMaxDecimals).toString().length+this.xAxisLabelPrefix.length+this.xAxisLabelSuffix.length,this.labelHeightX=this.xAxisHeight,this.longestLabelWidthX=this.longestLabelX*this.labelHeightX},e.prototype.calculateDrawingPropertiesY=function(){this.yAxisHeight=this.height-this.topOffset-this.bottomOffset,this.yAxisWidth=this.leftOffset,this.longestLabelY=p(this.maxPlottingY+this.dataStepSizeY,this.yAxisLabelMaxDecimals).toString().length+this.yAxisLabelPrefix.length+this.yAxisLabelSuffix.length},e.prototype.calculateStepSizeX=function(){var t=this.preferredLabelStepsX,e=this.orderX;this.preferredLabelStepsX.forEach((function(i,s){t[s]*=e}));for(var i=0;i<t.length;i++){var s=t[i]-this.maxX%t[i];s==t[i]&&(s=0);var o=this.minX-this.minX%t[i];s=this.maxX+s,this.gridLineCountX=(s-o)/t[i]+1,this.drawingStepSizeX=this.xAxisWidth/(this.gridLineCountX-1),this.dataStepSizeX=t[i];var n=this.drawingStepSizeX<this.longestLabelWidthX;if(!(this.gridLineCountX>this.xAxisMaxLabels||n)){this.calculateDrawingRanges(o,this.minY,s,this.maxY);break}i==t.length-1&&(this.preferredLabelStepsX.forEach((function(e,i){t[i]*=10})),i=-1)}},e.prototype.calculateStepSizeY=function(){var t=this.preferredLabelStepsY,e=this.orderY;this.preferredLabelStepsY.forEach((function(i,s){t[s]*=e}));for(var i=0;i<t.length;i++){var s=t[i]-this.maxY%t[i];s==t[i]&&(s=0);var o=this.minY-this.minY%t[i];s=this.maxY+s,this.gridLineCountY=(s-o)/t[i]+1,this.drawingStepSizeY=this.yAxisHeight/(this.gridLineCountY-1),this.dataStepSizeY=t[i],this.calculateLabelHeightYaxis();var n=this.drawingStepSizeY<this.labelHeightY;if(!(this.gridLineCountY>this.yAxisMaxLabels||n)){this.calculateDrawingRanges(this.minX,o,this.maxX,s);break}i==t.length-1&&(this.preferredLabelStepsY.forEach((function(e,i){t[i]*=10})),i=-1)}},e.prototype.drawAxis=function(){h("#fff",this.leftOffset,this.height-this.bottomOffset,this.width-this.leftOffset-this.rightOffset,this.ctx),r("#fff",this.leftOffset,this.height-this.bottomOffset,this.height-this.topOffset-this.bottomOffset,this.ctx);for(var t=0;t<this.gridLineCountY;t+=1){var e=this.topOffset+this.yAxisHeight-t*this.drawingStepSizeY,i=this.minPlottingY+this.dataStepSizeY*t;i=p(i,this.longestLabelY);var s=this.longestLabelY-i.toString().length-this.yAxisLabelPrefix.length-this.yAxisLabelSuffix.length;s>this.yAxisLabelMaxDecimals&&(s=this.yAxisLabelMaxDecimals),i=g(i,s),a(i=this.yAxisLabelPrefix+i+this.yAxisLabelSuffix,this.yAxisWidth/2,e,this.labelHeightY,"#fff",this.ctx),this.drawGridLineX&&h("#fff",this.leftOffset,e,this.width-this.leftOffset-this.rightOffset,this.ctx)}for(t=0;t<this.gridLineCountX;t+=1)e=this.leftOffset+t*this.drawingStepSizeX,this.xLabelNames?i=this.xLabelNames[t]:(i=p(i=this.minPlottingX+this.dataStepSizeX*t,this.longestLabelX),(s=this.longestLabelX-i.toString().length-this.xAxisLabelPrefix.length-this.xAxisLabelSuffix.length)>this.xAxisLabelMaxDecimals&&(s=this.xAxisLabelMaxDecimals),i=g(i,s)),i=this.xAxisLabelPrefix+i+this.xAxisLabelSuffix,s=this.xAxisHeight/2,this.equalLabelSize&&this.labelHeightX>this.labelHeightY&&(this.labelHeightX=this.labelHeightY),a(i,e,this.height-this.bottomOffset+s,this.labelHeightX,"#fff",this.ctx),this.drawGridLineY&&r("#fff",e,this.height-this.bottomOffset,this.height-this.topOffset-this.bottomOffset,this.ctx)},e.prototype.draw=function(){for(var t=0;t<this.graphs.length;t++)"line"==this.graphs[t].type?(d(this.graphs[t].xCoordinates,this.graphs[t].yCoordinates,this.graphs[t].color,this.graphs[t].linewidth,this.ctx),l(this.graphs[t].xCoordinatesHighlight,this.graphs[t].yCoordinatesHighlight,this.graphs[t].color,this.graphs[t].dataPointRadius,this.graphs[t].dataPointLinewidth,!1,this.ctx)):"shadow"==this.graphs[t].type&&(d(this.graphs[t].xCoordinates,this.graphs[t].yCoordinates,this.graphs[t].color,this.graphs[t].linewidth,this.ctx),l(this.graphs[t].xCoordinatesHighlight,this.graphs[t].yCoordinatesHighlight,this.graphs[t].color,this.graphs[t].dataPointRadius,this.graphs[t].linewidth,!0,this.ctx),u(this.graphs[t].xCoordinates,this.graphs[t].yCoordinates,this.graphs[t].shadowColor,this.bottom-this.bottomOffset,this.ctx));this.drawAxis()};var c=function(t,e,i,s,o,n,a){a.lineWidth=o,a.strokeStyle=i,a.beginPath(),a.arc(t,e,s,0,2*Math.PI,!0),a.fillStyle=n?i:null,a.fill(),a.stroke(),n||(a.strokeStyle="rgb(255, 255, 255)",a.globalCompositeOperation="destination-out",a.fillStyle="rgba(255,255,255,255)",a.lineWidth=1,a.beginPath(),a.arc(t,e,s-o/2,0,2*Math.PI,!0),a.fill(),a.stroke(),a.globalCompositeOperation="source-over")},d=function(t,e,i,s,o){o.lineWidth=s,o.strokeStyle=i;for(var n=0;n<t.length;n++)o.beginPath(),o.moveTo(t[n],e[n]),o.lineTo(t[n+1],e[n+1]),o.stroke();for(o.fillStyle=i,o.linewidth=1,i=Math.ceil(s/2)-1,n=0;n<t.length;n++)o.beginPath(),o.arc(t[n],e[n],i,0,2*Math.PI,!0),o.fill()},u=function(t,e,i,s,o){for(o.globalCompositeOperation="destination-over",o.lineWidth=1,o.strokeStyle=i,o.fillStyle=i,i=0;i<t.length;i++)o.beginPath(),o.moveTo(t[i],e[i]),o.lineTo(t[i],s),o.lineTo(t[i+1],s),o.lineTo(t[i+1],e[i+1]),o.fill(),o.stroke();o.globalCompositeOperation="source-over"};function p(t,e){var i=(t=t.toString()).indexOf("E"),s=t.indexOf("e"),o=0;return-1<s?(o=parseFloat(t.substring(s+1)),t=t.substring(0,s)):-1<i&&(o=parseFloat(t.substring(i+1)),t=t.substring(0,i)),Number(Math.round(t+"e"+(o+e))+"e-"+e)}function m(t){return Math.pow(10,Math.floor(Math.log(Math.abs(t))/Math.LN10+1e-9))}function f(t){return Math.round(Math.log(t)/Math.log(10))}function g(t,e){var i=-1==(t=t.toString()).indexOf(".");if(i&&1==e)return t;for(i&&1<e&&(t+=".",e--),i=0;i<e;i++)t+="0";return t}var v=!1;window.addEventListener("load",(function(){v=!0})),e.prototype.doWhenLoaded=function(t){v?t.bind(this)():window.addEventListener("load",function(){t.bind(this)()}.bind(this))}}.call(window),o(896);var n=o(965);function a(){let t=new Date;return t.setHours(0,0,0),t}const h=new Intl.DateTimeFormat(["de-AT"],{hour:"2-digit",minute:"2-digit"}),r=640;function l(t){return 0==t?0:null!=t?(t-r)/(1024-r)*100:null}function c(){let t=document.createElement("div");t.id="dashboard",t.innerHTML='<div class="mdc-card gaugesCard" id="gaugeCard"> <div class="gaugeHeading mdc-typography--headline6" id="heading">Room</div> <div class="gauges" id="gauges"> <div id="tempGauge"></div> <div id="humGauge"></div> <div id="presGauge"></div> </div> </div> <div id="tempCard" class="mdc-card"> <div id="plotHeading"> <div id="plottedValueLabel" class="mdc-typography--headline7">Temperature</div> <div id="plotTimeframeSelection"> <div id="previousDay" class="material-icons dayNavigationButton">arrow_back_ios_new</div> <div id="currentDayLabel" class="mdc-typography--headline7">Today</div> <div id="nextDay" class="material-icons dayNavigationButton">arrow_forward_ios</div> </div> </div> <div id="tempPlot"></div> </div>',t.querySelector("#output");const e=t.querySelector("#tempPlot"),i=t.querySelector("#tempCard"),s=t.querySelector("#plottedValueLabel"),o=t.querySelector("#previousDay"),r=t.querySelector("#nextDay"),c=t.querySelector("#currentDayLabel"),d={};var u=[];let p=[];var m=0;let f=a();function g(){var t,e;t=f,e=a(),t.getFullYear()!==e.getFullYear()||t.getMonth()!==e.getMonth()||t.getDate()!==e.getDate()?c.innerText=f.toLocaleDateString():c.innerText="Today",w(f,v(f,1))}function v(t,e){let i=new Date(t);return new Date(i.setDate(t.getDate()+e))}function w(o,a){(0,n.Tl)(o,a).then((o=>{let a=Object.keys(o).length;if(p=Object.keys(o),0==a)return;!function(e){if(u.length>0)return t;const i=t.querySelector("#gaugeCard"),s=t.querySelector("#heading"),o=t.querySelector("#gauges"),n=t.querySelector("#tempGauge"),a=t.querySelector("#humGauge"),h=t.querySelector("#presGauge");for(var r=0;r<e;r++){const e=document.createElement("div");e.classList=i.classList;const r=document.createElement("div");r.classList=o.classList;const l=document.createElement("h5");l.classList=s.classList,l.innerText="Room";const c=document.createElement("div");c.classList=n.classList;const d=document.createElement("div");d.classList=a.classList;const p=document.createElement("div");p.classList=h.classList,r.appendChild(c),r.appendChild(d),r.appendChild(p),e.appendChild(l),e.appendChild(r),t.insertBefore(e,t.firstChild);const m=[c,d,p,l];u.push(m)}}(a);for(var r=0;r<a;r++)d[p[r]]=new b;for(var c=0;c<a;c++){const t=d[p[c]];if(null==t)continue;t.name=o[p[c]].name;let e=o[p[c]].measurements;for(r=0;r<e.length;r++){const i=new Date(e[r].time);t.times.push(i.getTime()/1e3),t.temps.push(e[r].temperature),t.hums.push(e[r].humidity),t.press.push(e[r].pressure),t.vol.push(l(e[r].voltage))}}(0,n.ub)().then((t=>{for(var e=a-1;e>=0;e--)d[p[e]].addGaugePanel(e,t[p[e]].measurements)}));let f=1/0,g=0;for(let t=0;t<a;t++){let e=d[p[t]].times[0],i=d[p[t]].times[d[p[t]].times.length-1];e<f&&(f=e),i>g&&(g=i)}if(f==1/0||0==g)return;const v=1e3*(g-f)/3;let w=[];for(r=0;r<4;r++){const t=new Date(1e3*f+v*r);let e=h.format(new Date(t));w.push(e)}let x=["temps","hums","press","vol"],M=["Temperature","Humidity","Pressure","Voltage"],y=["#4caf50","#0077c2","#9c64a6","#018786"],S=["#80e27e","#42a5f5","#ce93d8","#03DAC6"];var L=["° ","% ","","% "];i.onclick=function(){++m>x.length-1&&(m=0),function(t,i,o,n,a,h,r){let l=[];for(let e=0;e<p.length;e++){let s=t[p[e]];if(null==s[i][0])continue;let o={type:"line",x:s.times,y:s[i],xHighlight:s.times,yHighlight:s[i],shadowColor:h};0==e&&(o.type="shadow"),l.push(o)}e.parentElement.style.background=a,s.innerText=r,new Plot(e,{backgroundColor:a,xAxisSize:.08,yAxisSize:.08,yAxisLabelMaxDecimals:0,yAxisMaxLabels:15,yAxisLabelSuffix:n,drawGridLineX:!1,drawGridLineY:!1,preferredLabelStepsY:[1,2,5],xLabelNames:o,graphs:l})}(d,x[m],w,L[m],y[m],S[m],M[m])},m=x.length-1,i.click()}))}function b(){this.timeLabels=[],this.times=[],this.temps=[],this.hums=[],this.press=[],this.vol=[],this.name=""}return w(f),r.addEventListener("click",(t=>{f=v(f,1),v(f,1)>new Date&&(r.style.visibility="hidden"),g(),t.stopPropagation()})),o.addEventListener("click",(t=>{r.style.visibility="visible",f=v(f,-1),g(),t.stopPropagation()})),b.prototype.addGaugePanel=function(t,e){const i=u[t][0],s=u[t][1],o=u[t][2],n=u[t][3];let a=e.voltage;null!=a&&(a=Math.round(l(a)));var h=e.temperature,r=e.humidity,c=e.pressure;let d=0==a&&null==h&&null==r&&null==c;a=d?a=", <i class='material-icons'>battery_alert</i>Battery empty":null!=a?", <i class='material-icons'>battery_std</i>"+a+"%":"";let p=function(t){return t.toLocaleTimeString().slice(0,-3)}(new Date(e.time));d&&(p=new Date(e.time).toLocaleDateString());let m=function(t,e,i,s){let o=t,n=e,a=i,h=s;if(!function(t,e,i){return!(t<-50||t>50||i-t<-30||i-t>70||e<.5||e>17)}(o,n,a))return null;let r=a-o,l=function(t){let e=t,i=[-2836.5744,-6028.076559,19.54263612,-.02737830188,16261698e-12,7.0229056*Math.pow(10,-10),-1.8680009*Math.pow(10,-13)],s=e+273.15,o=2.7150305*Math.log(s);for(let t=0;t<i.length;t++)o+=i[t]*Math.pow(s,t-2);return o=.01*Math.exp(o),o}(o)*(h/100)/10;return o+.607562052+-.0227712343*o+8.06470249*Math.pow(10,-4)*o*o+-1.54271372*Math.pow(10,-4)*o*o*o+-3.24651735*Math.pow(10,-6)*o*o*o*o+7.32602852*Math.pow(10,-8)*o*o*o*o*o+1.35959073*Math.pow(10,-9)*o*o*o*o*o*o+-2.2583652*n+.0880326035*o*n+.00216844454*o*o*n+-1.53347087*Math.pow(10,-5)*o*o*o*n+-5.72983704*Math.pow(10,-7)*o*o*o*o*n+-2.55090145*Math.pow(10,-9)*o*o*o*o*o*n+-.751269505*n*n+-.00408350271*o*n*n+-5.21670675*Math.pow(10,-5)*o*o*n*n+1.94544667*Math.pow(10,-6)*o*o*o*n*n+1.14099531*Math.pow(10,-8)*o*o*o*o*n*n+.158137256*n*n*n+-6.57263143*Math.pow(10,-5)*o*n*n*n+2.22697524*Math.pow(10,-7)*o*o*n*n*n+-4.16117031*Math.pow(10,-8)*o*o*o*n*n*n+-.0127762753*n*n*n*n+9.66891875*Math.pow(10,-6)*o*n*n*n*n+2.52785852*Math.pow(10,-9)*o*o*n*n*n*n+4.56306672*Math.pow(10,-4)*n*n*n*n*n+-1.74202546*Math.pow(10,-7)*o*n*n*n*n*n+-5.91491269*Math.pow(10,-6)*n*n*n*n*n*n+.398374029*r+1.83945314*Math.pow(10,-4)*o*r+-1.7375451*Math.pow(10,-4)*o*o*r+-7.60781159*Math.pow(10,-7)*o*o*o*r+3.77830287*Math.pow(10,-8)*o*o*o*o*r+5.43079673*Math.pow(10,-10)*o*o*o*o*o*r+-.0200518269*n*r+8.92859837*Math.pow(10,-4)*o*n*r+3.45433048*Math.pow(10,-6)*o*o*n*r+-3.77925774*Math.pow(10,-7)*o*o*o*n*r+-1.69699377*Math.pow(10,-9)*o*o*o*o*n*r+1.69992415*Math.pow(10,-4)*n*n*r+-4.99204314*Math.pow(10,-5)*o*n*n*r+2.47417178*Math.pow(10,-7)*o*o*n*n*r+1.07596466*Math.pow(10,-8)*o*o*o*n*n*r+8.49242932*Math.pow(10,-5)*n*n*n*r+1.35191328*Math.pow(10,-6)*o*n*n*n*r+-6.21531254*Math.pow(10,-9)*o*o*n*n*n*r+-4.99410301*Math.pow(10,-6)*n*n*n*n*r+-1.89489258*Math.pow(10,-8)*o*n*n*n*n*r+8.15300114*Math.pow(10,-8)*n*n*n*n*n*r+7.5504309*Math.pow(10,-4)*r*r+-5.65095215*Math.pow(10,-5)*o*r*r+-4.52166564*Math.pow(10,-7)*o*o*r*r+2.46688878*Math.pow(10,-8)*o*o*o*r*r+2.42674348*Math.pow(10,-10)*o*o*o*o*r*r+1.5454725*Math.pow(10,-4)*n*r*r+5.2411097*Math.pow(10,-6)*o*n*r*r+-8.75874982*Math.pow(10,-8)*o*o*n*r*r+-1.50743064*Math.pow(10,-9)*o*o*o*n*r*r+-1.56236307*Math.pow(10,-5)*n*n*r*r+-1.33895614*Math.pow(10,-7)*o*n*n*r*r+2.49709824*Math.pow(10,-9)*o*o*n*n*r*r+6.51711721*Math.pow(10,-7)*n*n*n*r*r+1.94960053*Math.pow(10,-9)*o*n*n*n*r*r+-1.00361113*Math.pow(10,-8)*n*n*n*n*r*r+-1.21206673*Math.pow(10,-5)*r*r*r+-2.1820366*Math.pow(10,-7)*o*r*r*r+7.51269482*Math.pow(10,-9)*o*o*r*r*r+9.79063848*Math.pow(10,-11)*o*o*o*r*r*r+1.25006734*Math.pow(10,-6)*n*r*r*r+-1.81584736*Math.pow(10,-9)*o*n*r*r*r+-3.52197671*Math.pow(10,-10)*o*o*n*r*r*r+-3.3651463*Math.pow(10,-8)*n*n*r*r*r+1.35908359*Math.pow(10,-10)*o*n*n*r*r*r+4.1703262*Math.pow(10,-10)*n*n*n*r*r*r+-1.30369025*Math.pow(10,-9)*r*r*r*r+4.13908461*Math.pow(10,-10)*o*r*r*r*r+9.22652254*Math.pow(10,-12)*o*o*r*r*r*r+-5.08220384*Math.pow(10,-9)*n*r*r*r*r+-2.24730961*Math.pow(10,-11)*o*n*r*r*r*r+1.17139133*Math.pow(10,-10)*n*n*r*r*r*r+6.62154879*Math.pow(10,-10)*r*r*r*r*r+4.0386326*Math.pow(10,-13)*o*r*r*r*r*r+1.95087203*Math.pow(10,-12)*n*r*r*r*r*r+-4.73602469*Math.pow(10,-12)*r*r*r*r*r*r+5.12733497*l+-.312788561*o*l+-.0196701861*o*o*l+9.9969087*Math.pow(10,-4)*o*o*o*l+9.51738512*Math.pow(10,-6)*o*o*o*o*l+-4.66426341*Math.pow(10,-7)*o*o*o*o*o*l+.548050612*n*l+-.00330552823*o*n*l+-.0016411944*o*o*n*l+-5.16670694*Math.pow(10,-6)*o*o*o*n*l+9.52692432*Math.pow(10,-7)*o*o*o*o*n*l+-.0429223622*n*n*l+.00500845667*o*n*n*l+1.00601257*Math.pow(10,-6)*o*o*n*n*l+-1.81748644*Math.pow(10,-6)*o*o*o*n*n*l+-1.25813502*Math.pow(10,-3)*n*n*n*l+-1.79330391*Math.pow(10,-4)*o*n*n*n*l+2.34994441*Math.pow(10,-6)*o*o*n*n*n*l+1.29735808*Math.pow(10,-4)*n*n*n*n*l+1.2906487*Math.pow(10,-6)*o*n*n*n*n*l+-2.28558686*Math.pow(10,-6)*n*n*n*n*n*l+-.0369476348*r*l+.00162325322*o*r*l+-3.1427968*Math.pow(10,-5)*o*o*r*l+2.59835559*Math.pow(10,-6)*o*o*o*r*l+-4.77136523*Math.pow(10,-8)*o*o*o*o*r*l+8.6420339*Math.pow(10,-3)*n*r*l+-6.87405181*Math.pow(10,-4)*o*n*r*l+-9.13863872*Math.pow(10,-6)*o*o*n*r*l+5.15916806*Math.pow(10,-7)*o*o*o*n*r*l+-3.59217476*Math.pow(10,-5)*n*n*r*l+3.28696511*Math.pow(10,-5)*o*n*n*r*l+-7.10542454*Math.pow(10,-7)*o*o*n*n*r*l+-1.243823*Math.pow(10,-5)*n*n*n*r*l+-7.385844*Math.pow(10,-9)*o*n*n*n*r*l+2.20609296*Math.pow(10,-7)*n*n*n*n*r*l+-7.3246918*Math.pow(10,-4)*r*r*l+-1.87381964*Math.pow(10,-5)*o*r*r*l+4.80925239*Math.pow(10,-6)*o*o*r*r*l+-8.7549204*Math.pow(10,-8)*o*o*o*r*r*l+2.7786293*Math.pow(10,-5)*n*r*r*l+-5.06004592*Math.pow(10,-6)*o*n*r*r*l+1.14325367*Math.pow(10,-7)*o*o*n*r*r*l+2.53016723*Math.pow(10,-6)*n*n*r*r*l+-1.72857035*Math.pow(10,-8)*o*n*n*r*r*l+-3.95079398*Math.pow(10,-8)*n*n*n*r*r*l+-3.59413173*Math.pow(10,-7)*r*r*r*l+7.04388046*Math.pow(10,-7)*o*r*r*r*l+-1.89309167*Math.pow(10,-8)*o*o*r*r*r*l+-4.79768731*Math.pow(10,-7)*n*r*r*r*l+7.96079978*Math.pow(10,-9)*o*n*r*r*r*l+1.62897058*Math.pow(10,-9)*n*n*r*r*r*l+3.94367674*Math.pow(10,-8)*r*r*r*r*l+-1.18566247*Math.pow(10,-9)*o*r*r*r*r*l+3.34678041*Math.pow(10,-10)*n*r*r*r*r*l+-1.15606447*Math.pow(10,-10)*r*r*r*r*r*l+-2.80626406*l*l+.548712484*o*l*l+-.0039942841*o*o*l*l+-9.54009191*Math.pow(10,-4)*o*o*o*l*l+1.93090978*Math.pow(10,-5)*o*o*o*o*l*l+-.308806365*n*l*l+.0116952364*o*n*l*l+4.95271903*Math.pow(10,-4)*o*o*n*l*l+-1.90710882*Math.pow(10,-5)*o*o*o*n*l*l+.00210787756*n*n*l*l+-6.98445738*Math.pow(10,-4)*o*n*n*l*l+2.30109073*Math.pow(10,-5)*o*o*n*n*l*l+4.1785659*Math.pow(10,-4)*n*n*n*l*l+-1.27043871*Math.pow(10,-5)*o*n*n*n*l*l+-3.04620472*Math.pow(10,-6)*n*n*n*n*l*l+.0514507424*r*l*l+-.00432510997*o*r*l*l+8.99281156*Math.pow(10,-5)*o*o*r*l*l+-7.14663943*Math.pow(10,-7)*o*o*o*r*l*l+-2.66016305*Math.pow(10,-4)*n*r*l*l+2.63789586*Math.pow(10,-4)*o*n*r*l*l+-7.01199003*Math.pow(10,-6)*o*o*n*r*l*l+-1.06823306*Math.pow(10,-4)*n*n*r*l*l+3.61341136*Math.pow(10,-6)*o*n*n*r*l*l+2.29748967*Math.pow(10,-7)*n*n*n*r*l*l+3.04788893*Math.pow(10,-4)*r*r*l*l+-6.42070836*Math.pow(10,-5)*o*r*r*l*l+1.16257971*Math.pow(10,-6)*o*o*r*r*l*l+7.68023384*Math.pow(10,-6)*n*r*r*l*l+-5.47446896*Math.pow(10,-7)*o*n*r*r*l*l+-3.5993791*Math.pow(10,-8)*n*n*r*r*l*l+-4.36497725*Math.pow(10,-6)*r*r*r*l*l+1.68737969*Math.pow(10,-7)*o*r*r*r*l*l+2.67489271*Math.pow(10,-8)*n*r*r*r*l*l+3.23926897*Math.pow(10,-9)*r*r*r*r*l*l+-.0353874123*l*l*l+-.22120119*o*l*l*l+.0155126038*o*o*l*l*l+-2.63917279*Math.pow(10,-4)*o*o*o*l*l*l+.0453433455*n*l*l*l+-.00432943862*o*n*l*l*l+1.45389826*Math.pow(10,-4)*o*o*n*l*l*l+2.1750861*Math.pow(10,-4)*n*n*l*l*l+-6.66724702*Math.pow(10,-5)*o*n*n*l*l*l+3.3321714*Math.pow(10,-5)*n*n*n*l*l*l+-.00226921615*r*l*l*l+3.80261982*Math.pow(10,-4)*o*r*l*l*l+-5.45314314*Math.pow(10,-9)*o*o*r*l*l*l+-7.96355448*Math.pow(10,-4)*n*r*l*l*l+2.53458034*Math.pow(10,-5)*o*n*r*l*l*l+-6.31223658*Math.pow(10,-6)*n*n*r*l*l*l+3.02122035*Math.pow(10,-4)*r*r*l*l*l+-4.77403547*Math.pow(10,-6)*o*r*r*l*l*l+1.73825715*Math.pow(10,-6)*n*r*r*l*l*l+-4.09087898*Math.pow(10,-7)*r*r*r*l*l*l+.614155345*l*l*l*l+-.0616755931*o*l*l*l*l+.00133374846*o*o*l*l*l*l+.00355375387*n*l*l*l*l+-5.13027851*Math.pow(10,-4)*o*n*l*l*l*l+1.02449757*Math.pow(10,-4)*n*n*l*l*l*l+-.00148526421*r*l*l*l*l+-4.11469183*Math.pow(10,-5)*o*r*l*l*l*l+-6.80434415*Math.pow(10,-6)*n*r*l*l*l*l+-9.77675906*Math.pow(10,-6)*r*r*l*l*l*l+.0882773108*l*l*l*l*l+-.00301859306*o*l*l*l*l*l+.00104452989*n*l*l*l*l*l+2.47090539*Math.pow(10,-4)*r*l*l*l*l*l+.00148348065*l*l*l*l*l*l}(h,.5,h,r);m=Math.round(10*m)/10,n.innerHTML=this.name+" <span class='mdc-typography--subtitle2 subsensortext'>("+p+a+") utci: "+m+"°C</span",h=null==h?"- ":Math.round(10*h)/10,r=null==r?"- ":Math.round(r),c=null==c?"- ":Math.round(c);let f="";h<10&&h>=0&&(f=" "),new Gauge(i,f,h,"°",-10,40,"#fff","#000").animateValue(h,800),new Gauge(s," ",r,"% ",30,99,"#fff","#000").animateValue(r,800),new Gauge(o,"",c," mb",950,1050,"#fff","#000").animateValue(c,800)},t}const d="app-room-editor";class u extends HTMLElement{constructor(){super(),this.innerHTML='<div class="mdc-card room"> <div style="display:none" id="name-invalid">Namen eingeben!</div> <div class="roomRow"> <label>Name:</label> <div class="mdc-text-field"> <input id="roomname" type="text" class="mdc-text-field__input" placeholder="Room1"> </div> </div> <div class="roomRow"> <label>Sensor 1:</label> <div class="select-container"> <div class="mdc-select"><i class="mdc-select__dropdown-icon"></i><select id="sensor1" class="sendung mdc-select__native-control"> </select></div> </div> </div> <div class="roomRow"> <label>Sensor 2 (Optional):</label> <div class="select-container"> <div class="mdc-select"><i class="mdc-select__dropdown-icon"></i><select id="sensor2" class="sendung mdc-select__native-control"> </select></div> </div> </div> <div class="roomRow"> <label>Type</label> <div class="select-container"> <div class="mdc-select"><i class="mdc-select__dropdown-icon"></i><select id="type" class="sendung mdc-select__native-control"> <option>Average</option> <option>Maximum</option> <option>Minimum</option> </select></div> </div> </div> <div class="roomRow"> <div> <button id="remove" class="mdc-icon-button material-icons mdc-top-app-bar__action-item--unbounded">delete</button> </div> <div> <button id="save" class="mdc-icon-button material-icons mdc-top-app-bar__action-item--unbounded">save</button> </div> </div> </div>'}connectedCallback(){this.sensor1Select=this.querySelector("#sensor1"),this.sensor2Select=this.querySelector("#sensor2"),this.typeSelect=this.querySelector("#type"),this.removeButton=this.querySelector("#remove"),this.removeButton.addEventListener("click",this.delete.bind(this)),this.saveButton=this.querySelector("#save"),this.saveButton.addEventListener("click",this.save.bind(this)),this.nameInvalid=this.querySelector("#name-invalid"),this.roomname=this.querySelector("#roomname")}save(){let t=this.roomname.value;this.nameInvalid.style.display=t?"none":"block",t&&(this.id||(0,n.ab)(t,this.typeSelect.value,parseInt(this.sensor1Select.value),this.sensor2Select.value?parseInt(this.sensor2Select.value):null).then((t=>{this.id=t.room_id})))}delete(){this.id?(0,n.HN)(this.id).then((()=>{this.dispatchEvent(new CustomEvent("onremove"))})):this.dispatchEvent(new CustomEvent("onremove"))}setData(t,e,i,s,o){this.id=t,this.roomname.value=e,this.sensor1Select.value=i,this.sensor2Select.value=s,this.typeSelect.value=o}setSensors(t){const e={102:"Kagran",104:"Schlachthausgasse",100:"Wien/Hohe Warte",101:"Wien/Schwechat",103:"Hendl"};for(let i of[{select:this.sensor1Select,required:!0},{select:this.sensor2Select,required:!1}]){if(i.select.innerHTML="",!i.required){let t=document.createElement("option");i.select.appendChild(t)}for(let s of t){let t=document.createElement("option");t.innerText=e[s.sensor_id]||`Sensor ${s.sensor_id}`,t.value=s.sensor_id,i.select.appendChild(t)}}}}customElements.define(d,u);class p extends HTMLElement{constructor(){super(),this.innerHTML='<div id="rooms"> </div> <button id="add-room" class="mdc-fab" aria-label="Raum hinzufügen"> <div class="mdc-fab__ripple"></div> <span class="mdc-fab__icon material-icons">add</span> </button>',this.sensors=[]}connectedCallback(){this.roomsContainer=this.querySelector("#rooms"),this.addRoomButton=this.querySelector("#add-room"),this.addRoomButton.addEventListener("click",(()=>this.addRoom())),this.updateSensors(),this.refreshRooms()}refreshRooms(){(0,n.t8)().then((t=>{this.roomsContainer.innerHTML="";for(let e of t)this.addRoom(e)}))}addRoom(t){let e=new u;this.roomsContainer.appendChild(e),e.setSensors(this.sensors),t&&e.setData(t.room_id,t.name,t.sensor_id1,t.sensor_id2,t.type),e.addEventListener("onremove",(()=>{this.roomsContainer.removeChild(e)}))}updateSensors(){(0,n.w_)().then((t=>{this.sensors=t,this.roomsContainer.querySelectorAll(d).forEach((e=>{e.setSensors(t)}))}))}}customElements.define("app-rooms-component",p);const m="app-notification-editor";class f extends HTMLElement{constructor(){super(),this.innerHTML='<div class="mdc-card room"> <div style="display:none" id="name-invalid">Text eingeben!</div> <div class="roomRow"> <label>Message:</label> <div class="mdc-text-field"> <input id="messageText" type="text" class="mdc-text-field__input"> </div> </div> <div class="roomRow"> <label>Value to compare:</label> <div class="select-container"> <div class="mdc-select"><i class="mdc-select__dropdown-icon"></i><select id="value" class="mdc-select__native-control"> <option>Temperature</option> <option>Humidity</option> <option>Pressure</option> <option value="voltage">Battery</option> </select></div> </div> </div> <div class="roomRow"> <label>Room 1:</label> <div class="select-container"> <div class="mdc-select"><i class="mdc-select__dropdown-icon"></i><select id="room1" class="mdc-select__native-control"> </select></div> </div> </div> <div class="roomRow"> <label>Type</label> <div class="select-container"> <div class="mdc-select"><i class="mdc-select__dropdown-icon"></i><select id="type" class="sendung mdc-select__native-control"> <option>Greater than</option> <option>Less than</option> <option>Falling more than</option> <option>Rising more than</option> </select></div> </div> </div> <div class="roomRow"> <label>Room 2 (Optional):</label> <div class="select-container"> <div class="mdc-select"><i class="mdc-select__dropdown-icon"></i><select id="room2" class="sendung mdc-select__native-control"> </select></div> </div> </div> <div class="roomRow"> <label>Value:</label> <div class="mdc-text-field"> <input id="amount" type="number" step="0.5" value="0" class="mdc-text-field__input"> </div> </div> <div class="roomRow"> <div> <button id="remove" class="mdc-icon-button material-icons mdc-top-app-bar__action-item--unbounded">delete</button> </div> <div> <button id="save" class="mdc-icon-button material-icons mdc-top-app-bar__action-item--unbounded">save</button> </div> </div> </div>'}connectedCallback(){this.messagetext=this.querySelector("#messageText"),this.room1Select=this.querySelector("#room1"),this.room2Select=this.querySelector("#room2"),this.typeSelect=this.querySelector("#type"),this.value=this.querySelector("#value"),this.amount=this.querySelector("#amount"),this.removeButton=this.querySelector("#remove"),this.removeButton.addEventListener("click",this.delete.bind(this)),this.saveButton=this.querySelector("#save"),this.saveButton.addEventListener("click",this.save.bind(this)),this.nameInvalid=this.querySelector("#name-invalid")}delete(){this.id?(0,n.fP)(this.id).then((()=>{this.dispatchEvent(new CustomEvent("onremove"))})):this.dispatchEvent(new CustomEvent("onremove"))}save(){let t=this.messagetext.value;this.nameInvalid.style.display=t?"none":"block",t&&(this.id||(0,n.UI)(t,parseInt(this.room1Select.value),"Fixed Value"!=this.room2Select.value?parseInt(this.room2Select.value):null,this.typeSelect.value,parseFloat(this.amount.value),this.value.value).then((t=>{this.id=t.notification_id})))}delete(){this.id?(0,n.fP)(this.id).then((()=>{this.dispatchEvent(new CustomEvent("onremove"))})):this.dispatchEvent(new CustomEvent("onremove"))}setData(t,e,i,s,o,n,a){this.id=t,this.messagetext.value=e,this.room1Select.value=i,this.room2Select.value=s,this.typeSelect.value=n,this.value.value=a,this.amount.value=o}setRooms(t){for(let e of[{room:this.room1Select,required:!0},{room:this.room2Select,required:!1}]){if(e.room.innerHTML="",!e.required){let t=document.createElement("option");t.innerText="Fixed Value",t.value=null,e.room.appendChild(t)}for(let i of t){let t=document.createElement("option");t.innerText=`${i.name}`,t.value=i.room_id,e.room.appendChild(t)}}}}customElements.define(m,f);class g extends HTMLElement{constructor(){super(),this.innerHTML='<div id="notifications"> </div> <button id="add-notification" class="mdc-fab" aria-label="Raum hinzufügen"> <div class="mdc-fab__ripple"></div> <span class="mdc-fab__icon material-icons">add</span> </button>',this.rooms=[]}connectedCallback(){this.notificationsContainer=this.querySelector("#notifications"),this.addNotificationButton=this.querySelector("#add-notification"),this.addNotificationButton.addEventListener("click",(()=>this.addNotification())),this.updateRooms(),this.refreshNotifications()}refreshNotifications(){(0,n.Tr)().then((t=>{this.notificationsContainer.innerHTML="";for(let e of t)this.addNotification(e)}))}addNotification(t){let e=new f;this.notificationsContainer.appendChild(e),e.setRooms(this.rooms),t&&e.setData(t.notification_id,t.message,t.room_id1,t.room_id2,t.amount,t.type,t.value),e.addEventListener("onremove",(()=>{this.notificationsContainer.removeChild(e)}))}updateRooms(){(0,n.t8)().then((t=>{this.rooms=t,this.notificationsContainer.querySelectorAll(m).forEach((e=>{e.setRooms(t)}))}))}}customElements.define("app-notifications-component",g);let v,w=new class{constructor(t,e){this.routeResolver=t,this.routeRenderer=e,this.lastRoute=null,this.popStateListener=this.handlePopState.bind(this)}handlePopState(t){this.resolve(window.location.pathname,{searchParams:new URLSearchParams(window.location.search)}).then((t=>this.render(t)))}run(){let t=document.querySelector("base");this.basePrefix=t.getAttribute("href"),this.baseHref=t.href,window.addEventListener("popstate",this.popStateListener),this.resolve(window.location.pathname,{searchParams:new URLSearchParams(window.location.search)}).then((t=>this.render(t)))}destroy(){window.removeEventListener("popstate",this.popStateListener)}resolve(t,e){let i=this.getRoute(t);return Promise.resolve(this.routeResolver.resolve(this.lastRoute,i,this,e)).then((t=>!!t&&{resolved:t,currentRoute:i}))}render(t){return!!t&&(this.routeRenderer.render(t.resolved),this.lastRoute=t.currentRoute,!0)}getRoute(t){let e=t===this.baseHref,i=t.substr(0,this.basePrefix.length)===this.basePrefix;return e?"":i?t.substring(this.basePrefix.length):t}navigate(t,e,i){let s=new URL(t,this.baseHref);this.resolve(s.pathname,s).then((t=>{t&&(i?window.history.replaceState({},e||document.title,s.href):window.history.pushState({},e||document.title,s.href)),this.render(t)}))}}(new class{resolve(t,e,i){switch(e){case"debug":return o.e(707).then(o.bind(o,707)).then((function(t){return new t.DebugComponent}));case"rooms":return new p;case"notifications":return new g;case"":return c();default:return!1}}},new class{constructor(t){this.container=t,this.currentComponent=!1}render(t){t&&(this.currentComponent&&(this.container.innerHTML=""),this.container.appendChild(t),this.currentComponent=!0)}}(document.getElementById("content")));function b(){(!v||(new Date).getTime()-v>5e3&&"/"==window.location.pathname)&&(v=(new Date).getTime(),w.navigate("","Antischwitzomat",!0)),(0,n.QX)()}w.run(),function(t,e){t.forEach((t=>{t.addEventListener("click",(i=>{i.preventDefault(),e.navigate(t.getAttribute("href"))}))}))}(document.querySelectorAll("a"),w),document.querySelector("#home-button").addEventListener("click",(()=>w.navigate(""))),"serviceWorker"in navigator&&window.addEventListener("load",(async()=>{navigator.serviceWorker.register("./worker.js").then((t=>{})).catch((t=>{console.log("SW registration failed: ",t)}))})),(0,n.QX)(),window.addEventListener("focus",b),document.addEventListener("focus",b)}();
//# sourceMappingURL=f0f00b6edeee06228d19.bundle.js.map