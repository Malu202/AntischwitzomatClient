!function(){"use strict";let e={code:"code-8a253f6b581a3095aa0dc2fc98261fc8165d912c",asset:"asset-v1"},t=[{'revision':null,'url':'/85a540bcfc25eeb1be8e.bundle.js'},{'revision':null,'url':'/9cc1a6285630fa1c0c7a.bundle.js'},{'revision':'8e70d7a5d8759bd5dffd404ec5337f16','url':'/favicons/android-chrome-192x192.png'},{'revision':'6b08ad33acbdd1445dbc51c24b65987c','url':'/favicons/apple-touch-icon.png'},{'revision':'e93da9c54ff6042979af674f7c761160','url':'/favicons/browserconfig.xml'},{'revision':'d268e10ad06f3390b2c833055b05d3e4','url':'/favicons/favicon-16x16.png'},{'revision':'c013d4ea57fbb3e9194f1970b26db73e','url':'/favicons/favicon-32x32.png'},{'revision':'eafd8a2ea1cf24ed4f6025bfefac5c7b','url':'/favicons/favicon.ico'},{'revision':'946af3c9a3cfc8f80d9b9bb3774f77f9','url':'/favicons/mstile-150x150.png'},{'revision':'0624dcb90f16ed55645f1d524f05a998','url':'/favicons/safari-pinned-tab.svg'},{'revision':null,'url':'/index.0f09214b32e2cc4c9df1.css'},{'revision':'ce480a7e9b015c4ca3ff5495a17c24dc','url':'/index.html'},{'revision':'ac9fb4059fd015d16a42dc98b386b446','url':'/site.webmanifest'}];self.addEventListener("install",(function(n){let s=t.reduce(((e,t)=>(t.url.indexOf("favicons/")>-1?e.asset.push(t.url):e.code.push(t.url),e)),{asset:[],code:[]}),i=[{name:e.code,assets:[...s.code]},{name:e.asset,assets:s.asset}];n.waitUntil((async()=>{let e=i.map((async e=>{let t=await caches.open(e.name);await t.addAll(Array.from(new Set(e.assets)))}));await Promise.all(e)})())})),self.addEventListener("fetch",(function(t){if("navigate"!==t.request.mode)t.respondWith(caches.match(t.request).then((async e=>e||await fetch(t.request))));else{if("GET"!==t.request.method)return;t.respondWith(caches.match("index.html",{cacheName:e.code}).then((e=>e||fetch(t.request))))}})),self.addEventListener("activate",(function(t){console.log("service worker activated"),t.waitUntil((async()=>{let t=await caches.keys(),n=Object.values(e),s=t.filter((e=>n.indexOf(e)<0)).map((async e=>{await caches.delete(e)}));await Promise.all(s)})())})),self.addEventListener("push",(e=>{console.log("got push data"),console.log(e.data.text());const t={body:e.data.text(),icon:"favicons/android-chrome-192x192.png",badge:"favicons/android-chrome-192x192.png"};e.waitUntil(self.registration.showNotification("Antischwitzomat",t))})),self.addEventListener("notificationclick",(e=>{const t=new URL("/",location).href;e.notification.close(),e.waitUntil(clients.matchAll().then((e=>{for(let s of e)if(console.log(`comparing client url ${s.url} with ${t}`),(s.url||"").startsWith((n=t).length>1&&"/"==n[n.length-1]?n.substring(0,n.length-1):n))return s.focus();var n;return console.log("opening /"),clients.openWindow("/")})))})),self.addEventListener("pushsubscriptionchange",(function(e){e.waitUntil(fetch("https://antischwitzomat.glitch.me/pushsubscriptionchange",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({old_endpoint:e.oldSubscription?e.oldSubscription.endpoint:null,new_endpoint:e.newSubscription?e.newSubscription.endpoint:null,new_p256dh:e.newSubscription?e.newSubscription.toJSON().keys.p256dh:null,new_auth:e.newSubscription?e.newSubscription.toJSON().keys.auth:null})}).then((()=>{if(!response.ok)throw Error(response.statusText)})).catch((e=>{})))}))}();
//# sourceMappingURL=worker.js.map